#!/bin/sh

# configure script for
#
#  Miniweb
#
# Copyright (C) 2010 Bernd Stramm
#

usage () {
   echo 
   echo "$0 [OPTIONS]"
   echo
   echo "Options:"
   echo "--prefix=PREFIX   Install into PREFIX [${PREFIX}]"
   echo
}

COPYRIGHT=" Copyright (C) 2010 Bernd Stramm"
PREFIX=/usr
# see if they said anything about prefix
while test $# != 0
do
  case $1 in
  --*=*)
  ac_option=`expr "X$1" : 'X\([^=]*\)='`
  ac_optarg=`expr "X$1" : 'X[^=]*=\(.*\)'`
  ac_shift=:
  ;;
 *)
  ac_option=$1
  ac_optarg=$2
  ac_shift=shift
  ;;
  esac

case $ac_option in
  --help)
   usage
   exit 0
   ;;
  --prefix)
   PREFIX=$ac_optarg
   $ac_shift
   ;;
  *)
   echo "Bad option " $ac_option " " $ac_optarg
   usage
   shift
   ;;
  esac
shift

done 

QM=`sh ./findqmake.sh`
if [ ! $? == 0 ] ; then
  echo 
  echo "Error: Cannot find qmake"
  echo
  echo "       Check Qt installation? "
  echo
  exit 1
fi

echo "#" > Makefile
echo "# Makefile generated by configure" >> Makefile
echo "# Faux automake" >> Makefile
echo "# ${COPYRIGHT}" >> Makefile
echo "#" >> Makefile
echo "PREFIX=${PREFIX}" >> Makefile
echo "DESTDIR=\${PREFIX}/bin" >> Makefile
echo "QMAKE = qmake" >> Makefile
echo "QMAKE = $QM" >> Makefile
cat Makefile.in >> Makefile
echo ""
echo "qmake is                  " $QM
echo "Installation prefix is    " $PREFIX
echo "Now you can build with      make"

